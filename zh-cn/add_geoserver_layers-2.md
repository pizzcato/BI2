# 添加图层

> 由渲染事件控制触发地图渲染图层动作,并提供所需要的图层参数  

## 添加渲染事件动作

![图 4](https://s2.loli.net/2022/05/26/1fe8uSpldtJrHjP.png '添加图层动作')  

>[!TIP]
>对于图层,在业务功能上又分为两种,分别为**主图层**和**附加图层**  
>主图层根据指标渲染时是否需要定位分为`添加或置顶一个图层`和<code>添加或置顶一个图层**并定位**</code>  
>如果需要在渲染时定位,由于往往渲染事件不好携带定位信息,所以习惯上更倾向于将渲染和定位分离开,单独设置  

对于两种图层,在指定加载该动作的时候,都需要提供以下3个参数

* **服务器编号**  
  这个参数对应页面`全局地理信息`上的`Geoserver信息`中的geoserver编号  
  ![图 5](https://s2.loli.net/2022/05/26/bol6uQjxaskOCn2.png)  
* **图层名**  
  这个参数对应页面`全局地理信息`上的`业务图层`信息中的`图层名`  
  图层名作为主键,用于判断图层是否加载/隐藏图层/添加附加图层/导出图层等多个功能上,不同指标的图层名**不要重复**
  **可以提供逗号分隔的图层名来一次触发多个图层的渲染**(如树状下拉框的多选事件)  
* **图层标题**
  这个参数用于在地图上可读性地显示图层标题。  
  ![图 15](https://s2.loli.net/2022/05/27/C1SLAVDEe7YbMch.png)  

如果是附加图层,需要额外指定父图层名  
如果需要定位,需要额外指定定位坐标  

## 设置渲染事件图层列表  

![图 8](https://s2.loli.net/2022/05/26/HZEGWeF8osNIqRY.png)  

>[!TIP]
>此处设置的是事件所能加载的图层资源池,也就是说触发渲染事件后,根据传递的图层名会在图层列表中匹配,匹配到才会加载,每个事件拥有的图层列表是相互独立的

### 添加业务图层列表记录

业务图层列表字段:

* **图层名**  
  和[动作](#添加渲染事件动作)中的图层表示的含义是相同的,添加时,会在`业务图层`中进行查询添加  
* **划过标题&划过字段**  
  设置geoserver图层中的一个字段  
  对矢量类型的图层,可以设置划过时,对象显示的信息  
  只适用于非图层瓦片图层  
* **标题字段**  
  设置geoserver图层中的一个字段  
  对于点类型的矢量图层,可以设置直接显示在地图上的文字![图 10](https://s2.loli.net/2022/05/26/AUj946BcRpgqa7b.png '光柱图层显示的文字')  
* **高度字段**  
  设置geoserver图层中的一个字段  
  用于设置2.5d图层的高度偏置,单位为`m`

### 添加/更新业务图层列表参数

添加好**一条**图层列表记录后,点击该记录,会向geoserver服务器查询对应图层所需要的参数列表,其中图层参数就是geoserver图层所需要的viewparam参数,组件参数中设置提供给geoserver的参数。
![图 11](https://s2.loli.net/2022/05/26/QKBfbc7r5msiuSM.png)  
按相同方法,将渲染事件所需要的业务图层全部添加上.  

>[!NOTE|label:注意事项]
>* 同一个渲染事件对应的所有业务图层列表中的图层参数,如果存在同名的参数,则设置或修改了其中一个,其余的会自动进行设置/修改  
>* 设置完业务图层参数后,需要点击各个图层刷新一下,配置才会生效  
